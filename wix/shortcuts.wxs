<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <Fragment>

    <ComponentGroup Id="LuaShortcuts">
      
      <!-- Remove StartMenu main dir in uninstall -->
      <Component Id="Cleanup_LuaMenu" Guid="*" Directory="LuaMenu">
	<RegistryValue Root="HKCU" Key="Software\Lua" Name="MainDirCleanup" Type="integer" Value="1" KeyPath="yes"/>
	<RemoveFolder Id="RF_LuaMenu" Directory="LuaMenu" On="uninstall"/>
      </Component>

      <!-- Lua CLI -->
      <Component Id="Shortcut_LUAEXE" Guid="*" Directory="LuaMenu">
        <Shortcut Id="SC_LUAEXE"
                  Name="Lua Command Line Interpreter"
                  Target="[INSTALL_ROOT]bin\lua.exe" />
        <RegistryValue Root="HKCU" Key="Software\Lua" Name="LUAEXE" Type="integer" Value="1" KeyPath="yes"/>
      </Component>

      <!-- ZeroBrane Studio -->
      <Component Id="Shortcut_ZBSTUDIO" Guid="*" Directory="LuaMenu">
        <Shortcut Id="SC_ZBSTUDIO"
                  Name="Lua IDE - ZeroBrane Studio"
                  Target="[INSTALL_ROOT]opt\ZeroBraneStudio\zbstudio.exe" />
        <RegistryValue Root="HKCU" Key="Software\Lua" Name="ZBSTUDIO" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
      
      <!-- DistroCheck -->
      <Component Id="Shortcut_DISTROCHECK" Guid="*" Directory="LuaMenu">
        <Shortcut Id="SC_DISTROCHECK"
                  Name="DistroCheck - Distribution Integrity Checker"
                  Target="[INSTALL_ROOT]opt\DistroCheck\DistroCheck.exe" />
        <RegistryValue Root="HKCU" Key="Software\Lua" Name="DISTROCHECK" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
      
      <!-- Help Center -->
      <Component Id="Shortcut_HELP_CENTER" Guid="*" Directory="LuaMenu">
        <Shortcut Id="SC_HELP_CENTER"
                  Name="OneLuaPro Help Center"
                  Target="[INSTALL_ROOT]share\doc\index.html" />
        <RegistryValue Root="HKCU" Key="Software\Lua" Name="HELP_CENTER" Type="integer" Value="1" KeyPath="yes"/>
      </Component>

    </ComponentGroup>
  </Fragment>

</Wix>
